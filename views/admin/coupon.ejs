<!--include header-->
<%- include("../layout/layout")%>
<%- include("../partials/admin-header")%>
<!-- /header -->
<section>
    <div class="container mt-4 mb-5">
        <div class="row ">
            
            <div class="conatiner my-3 pb-2 "style="float-right">
                <a href="/admin/couponAdding">
                    <button class="btn btn-primary text-green" type="button" value="Search">Add-Coupon</button>
                </a>
            </div>
                <div class="bg-light-title text-center py-3 mb-1">
                    <h2 class="mx-auto w-100">Coupon</h2>
                </div>
                <table class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th scope="col">Coupon Name</th>
                            <th scope="col">Discount Perc</th>
                            <th scope="col">Expiry Date</th>
                            <th scope="col">Min Value</th>
                            <th colspan="2">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% coupons.forEach((coupon,index)=>{ %>
                        <tr>
                            <!-- <th scope="row">1</th> -->
                            <td><%= coupon.couponName %></td>
                            <td><%= coupon.disc_Perc %></td>
                            <td><%= coupon.expiryDate %></td>
                            <td> <%=coupon.minValue%></td>
                            
                            <td>  
                                  
                                    <!-- <form action="/admin/couponDelete/<%=coupon._id%>" method="post">
                                <div
                                    class="d-flex align-items-center justify-content-center">
                                    <button
                                        class="btn btn-danger m-2 d-flex justify-content-center"
                                        style="font-size: 13px;" type="submit"
                                        onclick="">
                                        Remove
                                    </button>
                                </div>
                            </form> -->

                            <% if(coupon.isAvailable===true){%>
                                <form action="/admin/unlistCoupon/<%= coupon._id %>" method="POST">
                                    <button class="btn btn-danger m-2 text" type="submit"  onclick="confirmAlert(this.form)">Unlist</button>
                                </form>
                                <% } else if(coupon.isAvailable===false){%>
                                    <form action="/admin/listCoupon/<%= coupon._id %>" method="POST">
                                        <button class="btn btn-danger m-2 text" type="submit"  onclick="confirmAlert(this.form)">list</button>
                                    </form>
                                    <%}%>
                            </td>
                        </tr>
                        <% }); %>
                    </tbody>
                </table>
            </div>
        
    </div>
</section>
<!-- --include footer-- -->
<%- include("../partials/adminFooter")%>
<!-- /header -->
<script>
     
    function confirmAlert(form) {
        event.preventDefault();
        swal({
            title: "Are you sure?",
            text: "Do you want to proceed",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    // Allow the form to submit
                        form.submit();
                    // swal("Poof! This user has been blocked!", {
                    //     icon: "success",
                    // });
                } else {
                    swal("No changes made!");
                }
            });
    }
</script>